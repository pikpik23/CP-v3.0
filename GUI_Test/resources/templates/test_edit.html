{% extends 'layout.html' %} {% block body %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
 


<script type="text/javascript">
$(document).ready(function($)
{
	//ajax row data
	var ajax_data =
	[
		{serial:"Code", desc:"With Mark", type:"mark@codewithmark.com"}, 
		{serial:"Mary", desc:"Moe", type:"mary@gmail.com"},
		{serial:"John", desc:"Doe", type:"john@yahoo.com"},
		{serial:"Julie", desc:"Dooley", type:"julie@gmail.com"},
	]



	var random_id = function  () 
	{
		var id_num = Math.random().toString(9).substr(2,3);
		var id_str = Math.random().toString(36).substr(2);
		
		return id_num + id_str;
	}


	//--->create data table > start
	var tbl = '';

	$(document).find('.btn_save').hide();
	$(document).find('.btn_cancel').hide(); 
 
	//--->button > edit > start	
	$(document).on('click', '.btn_edit', function(event) 
	{
		event.preventDefault();
		var tbl_row = $(this).closest('tr');

		var row_id = tbl_row.attr('row_id');

		tbl_row.find('.btn_save').show();
		tbl_row.find('.btn_cancel').show();

		//hide edit button
		tbl_row.find('.btn_edit').hide(); 

		//make the whole row editable
		tbl_row.find('.row_data')
		.attr('contenteditable', 'true')
		.attr('edit_type', 'button')
		.addClass('bg-warning')
		.css('padding','3px')

		//--->add the original entry > start
		tbl_row.find('.row_data').each(function(index, val) 
		{  
			//this will help in case user decided to click on cancel button
			$(this).attr('original_entry', $(this).html());
		}); 		
		//--->add the original entry > end

	});
	//--->button > edit > end


	//--->button > cancel > start	
	$(document).on('click', '.btn_cancel', function(event) 
	{
		event.preventDefault();

		var tbl_row = $(this).closest('tr');

		var row_id = tbl_row.attr('row_id');

		//hide save and cacel buttons
		tbl_row.find('.btn_save').hide();
		tbl_row.find('.btn_cancel').hide();

		//show edit button
		tbl_row.find('.btn_edit').show();

		//make the whole row editable
		tbl_row.find('.row_data')
		.attr('edit_type', 'click')
		.removeClass('bg-warning')
		.css('padding','') 

		tbl_row.find('.row_data').each(function(index, val) 
		{   
			$(this).html( $(this).attr('original_entry') ); 
		});  
	});
	//--->button > cancel > end

	
	//--->save whole row entery > start	
	$(document).on('click', '.btn_save', function(event) 
	{
		event.preventDefault();
		var tbl_row = $(this).closest('tr');

		var row_id = tbl_row.attr('row_id');

		
		//hide save and cacel buttons
		tbl_row.find('.btn_save').hide();
		tbl_row.find('.btn_cancel').hide();

		//show edit button
		tbl_row.find('.btn_edit').show();


		//make the whole row editable
		tbl_row.find('.row_data')
		.attr('edit_type', 'click')
		.removeClass('bg-warning')
		.css('padding','') 

		//--->get row data > start
		var arr = {}; 
		tbl_row.find('.row_data').each(function(index, val) 
		{   
			var col_name = $(this).attr('col_name');  
			var col_val  =  $(this).html();
			arr[col_name] = col_val;
		});
		//--->get row data > end

		//use the "arr"	object for your ajax call
		$.extend(arr, {row_id:row_id});


	});
	//--->save whole row entery > end


}); 
</script>
<div class="mainSetting">
	<table class="table_serials">
		<thead>
			<tr>
				<th>Serial</th>
				<th>Description</th>
				<th>Type</th>
				<th>Options</th>
			</tr>
		</thead>
		<tbody>
				{% for serial, info in serials_def[return_type].items() %}
					<tr row_id="{{ serial }}"></tr>
						<td><div class="row_data" col_name="serial">{{serial}}</div></td>
						<td><div class="row_data" col_name="desc">{{info['desc']}}</div></td>
						<td><div class="row_data" col_name="type">{{info['data_type']}}</div></td>
						<td>
								<span class="btn_edit"> <a href="#" class="btn btn-link " row_id="{{serial}}" > Edit</a> </span>
								<span class="btn_save"> <a href="#" class="btn btn-link " row_id="{{serial}}" > Save</a> </span>
								<span class="btn_cancel"> <a href="#" class="btn btn-link " row_id="{{serial}}" > Cancel</a> </span>
						</td>
					</tr>
				{% endfor %}

		</tbody>

	</table>
</div>

{% endblock %}